"Conditions"
	{
	"Condition"
		{
		"instance"	"<ITEM_TS_BRIDGE_PANEL>"
		"Condition"
			{
			// Force the bridge on if no inputs are provided.
			"InstVar" "$conn_count_b = 0"
			"Result"
				{
				"SetInstVar" "$start_enabled 1"
				}
			}
		"Condition"
			{
			"InstVar"   "$conn_count_a = 0"
			"Result" // The panel is immoveable, just need to directly control the bridge.
				{
				"ChangeInstance" "instances/BEE2/clean/items/panel_bridge/common_static.vmf"
				"Switch"
					{
					"Flag" "instvar"
					"$animation ramp_30_deg_open"
						{
						"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_30.vmf"
						"SetInstVar" "$template BEE2_ANGLED_LIGHT_BRIDGE_TOP:static_30"
						"Condition"
							{
							"InstVar" "$start_reversed 1"
							"Result"
								{
								"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_30_vert.vmf"
								}
							"Else"
								{
								"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_30_horiz.vmf"
								}
							}
						}
					"$animation ramp_45_deg_open"
						{
						"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_45.vmf"
						"SetInstVar" "$template BEE2_ANGLED_LIGHT_BRIDGE_TOP:static_45"
						"Condition"
							{
							"InstVar" "$start_reversed 1"
							"Result"
								{
								"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_45_vert.vmf"
								}
							"Else"
								{
								"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_45_horiz.vmf"
								}
							}
						}
					"$animation ramp_60_deg_open"
						{
						"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_60.vmf"
						"SetInstVar" "$template BEE2_ANGLED_LIGHT_BRIDGE_TOP:static_60"
						"Condition"
							{
							"InstVar" "$start_reversed 1"
							"Result"
								{
								"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_60_vert.vmf"
								}
							"Else"
								{
								"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_60_horiz.vmf"
								}
							}
						}
					"$animation ramp_90_deg_open"
						{
						"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_90.vmf"
						"SetInstVar" "$template BEE2_ANGLED_LIGHT_BRIDGE_TOP:static_90"
						"Condition"
							{
							"InstVar" "$start_reversed 1"
							"Result"
								{
								"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_90_vert.vmf"
								}
							"Else"
								{
								"AddOverlay" "instances/BEE2/clean/items/panel_bridge/static_90_horiz.vmf"
								}
							}
						}
					}
				"TemplateBrush"
					{
					"ID" "$template"
					}
				"RemoveInstVar" "$template"
				}
			// Dynamic panel.
			"Else"
				{
				"ChangeInstance" "instances/BEE2/clean/items/panel_bridge/common_dynamic.vmf"
				"localTarget"
					{
					// Light Bridges by default don't have parenting in the FGD, so it doesn't
					// know to do fixup on the name. Instead provide a global name for it to use.
					// This will produce a name like "@lbp4567-pan_top".
					"Prefix" "@"
					"Name"   "pan_top"
					"resultVar" "$pan_top"
					}
				"TemplateBrush"
					{
					"ID" "BEE2_ANGLED_LIGHT_BRIDGE_TOP:dynamic"
					"Keys"
						{
						"classname" "func_brush"
						"drawinfastreflection" "1"
						"targetname" "$pan_top"
						}
					"LocalKeys"
						{
						"parentname" "model_arms,panel_attach"
						}
					}
				"Condition"
					{
					"InstVar" "$start_deployed 0"
					"Result"
						{
						"AddOverlay" "instances/BEE2/clean/items/panel_bridge/spawnclose.vmf"
						}
					}
				"Condition"
					{
					"InstVar" "$start_reversed 1"
					"Result"
						{
						"AddOverlay" "instances/BEE2/clean/items/panel_bridge/dynamic_vert.vmf"
						}
					"Else"
						{
						"AddOverlay" "instances/BEE2/clean/items/panel_bridge/dynamic_horiz.vmf"
						}
					}
				}
			}
		}
	}
